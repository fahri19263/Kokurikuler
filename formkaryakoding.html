<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Pengumpulan Tugas - Pelatihan Koding</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .form-container {
            backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
        }
        
        .input-focus:focus {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .submit-btn {
            background: linear-gradient(45deg, #4f46e5, #7c3aed);
            transition: all 0.3s ease;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(79, 70, 229, 0.4);
        }
        
        .success-animation {
            animation: successPulse 0.6s ease-in-out;
        }
        
        @keyframes successPulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .loading-spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #4f46e5;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="gradient-bg min-h-screen py-8 px-4">
    <div class="max-w-2xl mx-auto">
        <!-- Header -->
        <div class="text-center mb-8">
          
            <h1 class="text-3xl font-bold text-white mb-2">Form Berbagi Hasil Karya</h1>
            <p class="text-blue-100 text-lg">Pelatihan Koding</p>
        </div>

        <!-- Form Container -->
        <div class="form-container rounded-2xl shadow-2xl p-8">
            <form id="taskForm" class="space-y-6">
                <!-- Nama -->
                <div class="space-y-2">
                    <label for="nama" class="block text-sm font-semibold text-gray-700">
                        Nama Lengkap <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="nama" 
                        name="nama" 
                        required
                        class="input-focus w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        placeholder="Masukkan nama lengkap Bapak / Ibu Guru"
                    >
                </div>

                <!-- Mapel -->
                <div class="space-y-2">
                    <label for="mapel" class="block text-sm font-semibold text-gray-700">
                        Mata Pelajaran yang Diampu <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="mapel" 
                        name="mapel" 
                        required
                        class="input-focus w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        placeholder="Contoh: Matematika, Bahasa Indonesia, IPA"
                    >
                </div>

                <!-- Asal Sekolah -->
                <div class="space-y-2">
                    <label for="sekolah" class="block text-sm font-semibold text-gray-700">
                        Instansi Tempat Mengajar <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="text" 
                        id="sekolah" 
                        name="sekolah" 
                        required
                        class="input-focus w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        placeholder="Nama sekolah tempat Bapak / Ibu mengajar"
                    >
                </div>

                <!-- Link Karya -->
                <div class="space-y-2">
                    <label for="linkKarya" class="block text-sm font-semibold text-gray-700">
                        Link Karya <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="url" 
                        id="linkKarya" 
                        name="linkKarya" 
                        required
                        class="input-focus w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        placeholder="https://scratch.mit.edu/projects/1091742791/... atau link lainnya"
                    >
                </div>

                <!-- Nomor Kontak -->
                <div class="space-y-2">
                    <label for="kontak" class="block text-sm font-semibold text-gray-700">
                        Nomor Kontak <span class="text-red-500">*</span>
                    </label>
                    <input 
                        type="tel" 
                        id="kontak" 
                        name="kontak"
                        required
                        class="input-focus w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-300"
                        placeholder="08xxxxxxxxxx atau +62xxxxxxxxxx"
                    >
                </div>

                <!-- Submit Button -->
                <div class="pt-4">
                    <button 
                        type="submit" 
                        id="submitBtn"
                        class="submit-btn w-full py-4 px-6 text-white font-semibold rounded-lg transition-all duration-300 flex items-center justify-center space-x-2"
                    >
                        <span id="submitText">Bagikan Karya</span>
                        <div id="loadingSpinner" class="loading-spinner hidden"></div>
                    </button>
                </div>
            </form>

            <!-- Success Message -->
            <div id="successMessage" class="hidden mt-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
                <div class="flex items-center">
                    <span class="text-2xl mr-3">‚úÖ</span>
                    <div>
                        <h3 class="font-semibold">Karya Berhasil Dibagikan!</h3>
                        <p class="text-sm">Terima kasih telah berbagi hasil karya Bapak / Ibu Guru</p>
                    </div>
                </div>
            </div>

            <!-- Error Message -->
            <div id="errorMessage" class="hidden mt-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
                <div class="flex items-center">
                    <span class="text-2xl mr-3">‚ùå</span>
                    <div>
                        <h3 class="font-semibold">Terjadi Kesalahan</h3>
                        <p class="text-sm" id="errorText">Silakan coba lagi atau hubungi administrator.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Confirmation Modal -->
        <div id="confirmationModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl transform transition-all">
                <div class="text-center">
                    <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">‚ùì</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Konfirmasi Berbagi Karya</h3>
                    <p class="text-gray-600 mb-6">Apakah data isian sudah benar?</p>
                    <div class="flex space-x-4">
                        <button id="cancelBtn" class="flex-1 px-4 py-3 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-semibold">
                            Batal
                        </button>
                        <button id="confirmBtn" class="flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-semibold">
                            Ya, Bagikan
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Success Modal -->
        <div id="successModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
            <div class="bg-white rounded-2xl p-8 max-w-md mx-4 shadow-2xl transform transition-all">
                <div class="text-center">
                    <div class="w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4">
                        <span class="text-2xl">üéâ</span>
                    </div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">Berhasil Dibagikan!</h3>
                    <p class="text-gray-600 mb-6">Terima kasih telah berbagi hasil karya Bapak / Ibu.</p>
                    <button id="closeSuccessBtn" class="w-full px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-semibold">
                        Tutup
                    </button>
                </div>
            </div>
        </div>

        <!-- Info Box -->
        <div class="mt-6 bg-white bg-opacity-20 rounded-lg p-4 text-white text-sm">
            <div class="flex items-start space-x-3">
                <span class="text-lg">üí°</span>
                <div>
                    <p class="font-semibold mb-1">Informasi:</p>
                    <ul class="space-y-1 text-blue-100">
                        <li>‚Ä¢ Kontak digunakan jika link karya tidak dapat terbuka</li>
                        <li>‚Ä¢ Kontak diperlukan untuk memudahkan dihubungi jika ada informasi terkait sertifikat pelatihan</li>
                        <li></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Local Storage Functions
        function saveToLocalStorage(data) {
            try {
                const submissions = JSON.parse(localStorage.getItem('taskSubmissions') || '[]');
                submissions.push({
                    ...data,
                    timestamp: new Date().toISOString(),
                    id: Date.now()
                });
                localStorage.setItem('taskSubmissions', JSON.stringify(submissions));
                
                // Also save current form data for auto-fill
                localStorage.setItem('currentFormData', JSON.stringify(data));
            } catch (error) {
                console.error('Error saving to localStorage:', error);
            }
        }

        function loadFromLocalStorage() {
            try {
                const savedData = localStorage.getItem('currentFormData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    document.getElementById('nama').value = data.nama || '';
                    document.getElementById('mapel').value = data.mapel || '';
                    document.getElementById('sekolah').value = data.sekolah || '';
                    document.getElementById('linkKarya').value = data.linkKarya || '';
                    document.getElementById('kontak').value = data.kontak || '';
                }
            } catch (error) {
                console.error('Error loading from localStorage:', error);
            }
        }

        // Auto-save form data as user types
        function setupAutoSave() {
            const inputs = ['nama', 'mapel', 'sekolah', 'linkKarya', 'kontak'];
            inputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                input.addEventListener('input', () => {
                    const formData = {
                        nama: document.getElementById('nama').value,
                        mapel: document.getElementById('mapel').value,
                        sekolah: document.getElementById('sekolah').value,
                        linkKarya: document.getElementById('linkKarya').value,
                        kontak: document.getElementById('kontak').value
                    };
                    localStorage.setItem('currentFormData', JSON.stringify(formData));
                });
            });
        }

        // Form submission
        document.getElementById('taskForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show confirmation modal
            document.getElementById('confirmationModal').classList.remove('hidden');
        });

        // Handle confirmation modal
        document.getElementById('cancelBtn').addEventListener('click', function() {
            document.getElementById('confirmationModal').classList.add('hidden');
        });

        document.getElementById('confirmBtn').addEventListener('click', async function() {
            // Hide confirmation modal
            document.getElementById('confirmationModal').classList.add('hidden');
            
            const submitBtn = document.getElementById('submitBtn');
            const submitText = document.getElementById('submitText');
            const loadingSpinner = document.getElementById('loadingSpinner');
            const successMessage = document.getElementById('successMessage');
            const errorMessage = document.getElementById('errorMessage');
            
            // Hide previous messages
            successMessage.classList.add('hidden');
            errorMessage.classList.add('hidden');
            
            // Show loading state
            submitBtn.disabled = true;
            submitText.textContent = 'Membagikan...';
            loadingSpinner.classList.remove('hidden');
            
            // Collect form data
            const formData = {
                nama: document.getElementById('nama').value,
                mapel: document.getElementById('mapel').value,
                sekolah: document.getElementById('sekolah').value,
                linkKarya: document.getElementById('linkKarya').value,
                kontak: document.getElementById('kontak').value
            };
            
            // Save to local storage
            saveToLocalStorage(formData);
            
            try {
                // Replace with your Google Apps Script Web App URL
                const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbySxTdqCQ2qCkHhZqZH_gKriPGnmgZfjDSIiNqZPWDVTATeJQp54sd4dfIqlY3QS8wg5Q/exec';
                
                // Send to Google Sheets (uncomment when you have the script URL)
                /*
                const response = await fetch(SCRIPT_URL, {
                    method: 'POST',
                         mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                */
                
                // Simulate API call for demo
                await new Promise(resolve => setTimeout(resolve, 2000));
                
                // Show success modal instead of inline message
                document.getElementById('successModal').classList.remove('hidden');
                
                // Clear form
                document.getElementById('taskForm').reset();
                localStorage.removeItem('currentFormData');
                
            } catch (error) {
                console.error('Error submitting form:', error);
                errorMessage.classList.remove('hidden');
                document.getElementById('errorText').textContent = 
                    'Terjadi kesalahan saat mengirim data. Data tetap tersimpan di browser Anda.';
            } finally {
                // Reset button state
                submitBtn.disabled = false;
                submitText.textContent = 'Bagikan Karya';
                loadingSpinner.classList.add('hidden');
            }
        });

        // Handle success modal close
        document.getElementById('closeSuccessBtn').addEventListener('click', function() {
            document.getElementById('successModal').classList.add('hidden');
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            setupAutoSave();
        });

        // Add input validation feedback
        document.querySelectorAll('input[required]').forEach(input => {
            input.addEventListener('blur', function() {
                if (this.value.trim() === '') {
                    this.classList.add('border-red-300');
                    this.classList.remove('border-gray-300');
                } else {
                    this.classList.remove('border-red-300');
                    this.classList.add('border-gray-300');
                }
            });
        });

        // URL validation for link karya
        document.getElementById('linkKarya').addEventListener('blur', function() {
            const urlPattern = /^https?:\/\/.+/;
            if (this.value && !urlPattern.test(this.value)) {
                this.classList.add('border-red-300');
                // You could add a small error message here
            } else {
                this.classList.remove('border-red-300');
            }
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9875f31dc7ae6cf0',t:'MTc1OTI1ODY4NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
